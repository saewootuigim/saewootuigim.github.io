


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Principal Component Analysis (PCA) &mdash; Seungbum&#39;s Website 1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/jquery.fancybox.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/glpi.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Seungbum&#39;s Website 1 documentation" href="../index.html"/>
        <link rel="up" title="Study" href="index_posts.html"/>
        <link rel="prev" title="Study" href="index_posts.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Seungbum's Website
          

          
          </a>

          
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publication.html">Publications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index_posts.html">Study</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Principal Component Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.-Normalize">1. Normalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Covariance-Matrix">2. Covariance Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Eigenvalue-Decomposition">3. Eigenvalue Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.-Preprocessing">4. Preprocessing</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Seungbum's Website</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index_posts.html">Study</a> &raquo;</li>
        
      <li>Principal Component Analysis (PCA)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/posts/pca.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
      
        <a href="index_posts.html" class="btn btn-neutral" title="Study" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Principal-Component-Analysis-(PCA)">
<h1>Principal Component Analysis (PCA)<a class="headerlink" href="#Principal-Component-Analysis-(PCA)" title="Permalink to this headline">¶</a></h1>
<p>Let’s say that we have a data set to train a machine learning algorithm. A data set usually takes the form of a two-dimensional array where every row is an instance, experiment, observation, or any term that may comfort you, and each column represents the variable, feature, parameter, or, as before, any name that may comfort you.</p>
<p>Typically, not all columns are mutually independent; instead, they are correlated to each other to some degree. It means that not all columns may be needed when training an algorithm when there are columns that are highly correlated to one another. If there is a way to remove such correlation and make every column mutually independent, then we may be able to reduce the number of columns, i.e., reduce the dimension. It can be done by PCA.</p>
<p>In mathematical language, PCA is an orthogonal projection of an <span class="math notranslate nohighlight">\(m\)</span>-dimensional vector on to some <span class="math notranslate nohighlight">\(l\)</span>-dimensional subspace, where <span class="math notranslate nohighlight">\(l\leqslant m\)</span>. If <span class="math notranslate nohighlight">\(l\)</span> is smaller than <span class="math notranslate nohighlight">\(m\)</span>, then we can benefit from the dimension reduction, while <span class="math notranslate nohighlight">\(l=m\)</span> is still good because every column becomes linearly independent to each other after PCA so that the multicollinearity is naturally resolved.</p>
<p>PCA typically follows the following steps</p>
<div class="section" id="1.-Normalize">
<h2>1. Normalize<a class="headerlink" href="#1.-Normalize" title="Permalink to this headline">¶</a></h2>
<p>Let’s say that a data set <span class="math notranslate nohighlight">\(\mathbf{X}^b\in\mathbb{R}^{n\times m}\)</span>is given. The superscript <span class="math notranslate nohighlight">\(b\)</span> stands for raw data. I will use superscript <span class="math notranslate nohighlight">\(a\)</span> for normalized data and no superscript for the final data.</p>
<p><span class="math notranslate nohighlight">\(\mathbf{X}^b\)</span> has <span class="math notranslate nohighlight">\(n\)</span> experimental data and <span class="math notranslate nohighlight">\(m\)</span> variables. We want to train a machine learning algorithm with it. What we have to do is normalization of data so that the data to have the mean at 0 and a standard deviation of 1, i.e.:</p>
<p><span class="math">\begin{gather}
\mathbf{x}^a_j=\frac{\mathbf{x}^b_j-\mathrm{mean}\left(\mathbf{x}^b_j\right)\mathbf{1}}{\sigma\left(\mathbf{x}^b_j\right)}
\end{gather}</span></p>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{x}^a_j\in\mathbb{R}^n\)</span> is the normalized column vector, mean<span class="math notranslate nohighlight">\(\left(\mathbf{x}^b_j\right)\)</span> is the mean of <span class="math notranslate nohighlight">\(\mathbf{x}^b_j\)</span> which is a scalar, <span class="math notranslate nohighlight">\(\mathbf{1}\in\mathbb{R}^n\)</span> is a vector where all entries are 1, and <span class="math notranslate nohighlight">\(\sigma\left(\mathbf{x}^b_j\right)\)</span> is the standard deviation of <span class="math notranslate nohighlight">\(\mathbf{x}^b_j\)</span>. The resulting new matrix <span class="math notranslate nohighlight">\(\mathbf{X}^a=\left[~\mathbf{x}^a_1~\cdots~\mathbf{x}^a_m~\right]\)</span> possesses identical information to <span class="math notranslate nohighlight">\(\mathbf{X}^b\)</span>
but it is column-wise normalized.</p>
<p>These are implemented as follows. First, read the data set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># This data set is from the University of California, Irvine Machine Learning Repository.
# Last column of this data set is the make and name of the cars, which will not be used in this example.

import pandas as pd

column_names = [&#39;MPG&#39;, &#39;Cylinders&#39;, &#39;Displacement&#39;, &#39;Horsepower&#39;, &#39;Weight&#39;, &#39;Acceleration&#39;, &#39;Model Year&#39;, &#39;Origin&#39;]
df = pd.read_csv(&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/auto-mpg/auto-mpg.data&quot;,names=column_names,na_values=&quot;?&quot;,comment=&quot;\t&quot;,sep=&quot; &quot;,skipinitialspace=True)
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MPG</th>
      <th>Cylinders</th>
      <th>Displacement</th>
      <th>Horsepower</th>
      <th>Weight</th>
      <th>Acceleration</th>
      <th>Model Year</th>
      <th>Origin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>3504.0</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>3693.0</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>3436.0</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16.0</td>
      <td>8</td>
      <td>304.0</td>
      <td>150.0</td>
      <td>3433.0</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.0</td>
      <td>8</td>
      <td>302.0</td>
      <td>140.0</td>
      <td>3449.0</td>
      <td>10.5</td>
      <td>70</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Let&#39;s do some pre-processing on the data set before starting PCA.
# There are nan values in the data.
df.isna().sum()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MPG             0
Cylinders       0
Displacement    0
Horsepower      6
Weight          0
Acceleration    0
Model Year      0
Origin          0
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Let&#39;s remove them.
import numpy as np

a = df.shape
df.dropna(inplace=True)
print(&quot;Size was {}&quot;.format(a)+&quot; is now {}&quot;.format(df.shape))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Size was (398, 8) is now (392, 8)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># &quot;Origin column&quot; is categorical. Let&#39;s remove it from the data frame and attach it after PCA.
origin = df.pop(&quot;Origin&quot;)
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MPG</th>
      <th>Cylinders</th>
      <th>Displacement</th>
      <th>Horsepower</th>
      <th>Weight</th>
      <th>Acceleration</th>
      <th>Model Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>3504.0</td>
      <td>12.0</td>
      <td>70</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>3693.0</td>
      <td>11.5</td>
      <td>70</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>3436.0</td>
      <td>11.0</td>
      <td>70</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16.0</td>
      <td>8</td>
      <td>304.0</td>
      <td>150.0</td>
      <td>3433.0</td>
      <td>12.0</td>
      <td>70</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.0</td>
      <td>8</td>
      <td>302.0</td>
      <td>140.0</td>
      <td>3449.0</td>
      <td>10.5</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><p>We normalize this.</p>
</p><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>X_norm = (df-df.mean())/df.std()
X_norm.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MPG</th>
      <th>Cylinders</th>
      <th>Displacement</th>
      <th>Horsepower</th>
      <th>Weight</th>
      <th>Acceleration</th>
      <th>Model Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.697747</td>
      <td>1.482053</td>
      <td>1.075915</td>
      <td>0.663285</td>
      <td>0.619748</td>
      <td>-1.283618</td>
      <td>-1.623241</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.082115</td>
      <td>1.482053</td>
      <td>1.486832</td>
      <td>1.572585</td>
      <td>0.842258</td>
      <td>-1.464852</td>
      <td>-1.623241</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.697747</td>
      <td>1.482053</td>
      <td>1.181033</td>
      <td>1.182885</td>
      <td>0.539692</td>
      <td>-1.646086</td>
      <td>-1.623241</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.953992</td>
      <td>1.482053</td>
      <td>1.047246</td>
      <td>1.182885</td>
      <td>0.536160</td>
      <td>-1.283618</td>
      <td>-1.623241</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.825870</td>
      <td>1.482053</td>
      <td>1.028134</td>
      <td>0.923085</td>
      <td>0.554997</td>
      <td>-1.827320</td>
      <td>-1.623241</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="2.-Covariance-Matrix">
<h2>2. Covariance Matrix<a class="headerlink" href="#2.-Covariance-Matrix" title="Permalink to this headline">¶</a></h2>
<p>Next, we need to compute the covariance between each column. The definition of covariance is</p>
<p><span class="math">\begin{gather}
\mathbf{Cov}=\frac{1}{n-1}\mathbf{X}^{aT}\mathbf{X}^a
\end{gather}</span></p>
<p>but the DataFrame class in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> already has covariance method. So we do it in following way.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cov = X_norm.cov()
with pd.option_context(&#39;display.max_rows&#39;, None, &#39;display.max_columns&#39;, None):
  display(cov)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MPG</th>
      <th>Cylinders</th>
      <th>Displacement</th>
      <th>Horsepower</th>
      <th>Weight</th>
      <th>Acceleration</th>
      <th>Model Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MPG</th>
      <td>1.000000</td>
      <td>-0.777618</td>
      <td>-0.805127</td>
      <td>-0.778427</td>
      <td>-0.832244</td>
      <td>0.423329</td>
      <td>0.580541</td>
    </tr>
    <tr>
      <th>Cylinders</th>
      <td>-0.777618</td>
      <td>1.000000</td>
      <td>0.950823</td>
      <td>0.842983</td>
      <td>0.897527</td>
      <td>-0.504683</td>
      <td>-0.345647</td>
    </tr>
    <tr>
      <th>Displacement</th>
      <td>-0.805127</td>
      <td>0.950823</td>
      <td>1.000000</td>
      <td>0.897257</td>
      <td>0.932994</td>
      <td>-0.543800</td>
      <td>-0.369855</td>
    </tr>
    <tr>
      <th>Horsepower</th>
      <td>-0.778427</td>
      <td>0.842983</td>
      <td>0.897257</td>
      <td>1.000000</td>
      <td>0.864538</td>
      <td>-0.689196</td>
      <td>-0.416361</td>
    </tr>
    <tr>
      <th>Weight</th>
      <td>-0.832244</td>
      <td>0.897527</td>
      <td>0.932994</td>
      <td>0.864538</td>
      <td>1.000000</td>
      <td>-0.416839</td>
      <td>-0.309120</td>
    </tr>
    <tr>
      <th>Acceleration</th>
      <td>0.423329</td>
      <td>-0.504683</td>
      <td>-0.543800</td>
      <td>-0.689196</td>
      <td>-0.416839</td>
      <td>1.000000</td>
      <td>0.290316</td>
    </tr>
    <tr>
      <th>Model Year</th>
      <td>0.580541</td>
      <td>-0.345647</td>
      <td>-0.369855</td>
      <td>-0.416361</td>
      <td>-0.309120</td>
      <td>0.290316</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We see that the off-diagonal elements are very large (far from 0 and close to 1) which indicates the PCA would be meaningful.</p>
</div>
<div class="section" id="3.-Eigenvalue-Decomposition">
<h2>3. Eigenvalue Decomposition<a class="headerlink" href="#3.-Eigenvalue-Decomposition" title="Permalink to this headline">¶</a></h2>
<p>Now, it is time to analyze and obtain the principal components. Actually, the eigenvalue decomposition is everything you need to do.</p>
<p><span class="math">\begin{gather}
\mathbf{Cov}=\mathbf{V}\boldsymbol{\Lambda}\mathbf{V}^T.
\end{gather}</span></p>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> is a matrix that has eigenvectors of <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> as its column vectors and <span class="math notranslate nohighlight">\(\boldsymbol{\Lambda}\)</span> is a diagonal matrix having eigenvalues as its entries. Algebraic and geometric multiplicities are not strictly considered. Actually, for the real world data, it is rare to see such situation unless there are duplicated columns exist in the data set <span class="math notranslate nohighlight">\(\mathbf{X}^b\)</span>.</p>
<p>The eigenvalues are, in fact, the variance, or importance, of corresponding the eigenvector, and the corresponding eigenvector is the <em>recipe</em> to generate the corresponding prinicpal component: dot product of row <span class="math notranslate nohighlight">\(i\)</span> in <span class="math notranslate nohighlight">\(\mathbf{X}^a\)</span> and eigenvector 1 yield principal component 1. In general</p>
<p><span class="math">\begin{gather}
\mathbf{x}_i=\mathbf{x}^a_i\mathbf{V}.
\end{gather}</span></p>
<p>To represent whole data by PCA, one should choose all the principal components to create a new data set. Such approach would not be able to reduce the dimension, however, this preprocessed data set is de-correlated and the learning algorithm should return better prediction with shorter training time. On the other hand, one could choose several significant PCs to approximately represent the data and reduce the dimension of input data set without loosing much information of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> has <code class="docutils literal notranslate"><span class="pre">eig</span></code> method which does the work for you, but it is not sorted.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>w, v = np.linalg.eig(cov)
for i in range(len(w)):
    print(&quot;norm of col {:1d} = {:.4f}, lambda={:.4f}&quot;.format(i,np.linalg.norm(v[:,i]),w[i]))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
norm of col 0 = 1.0000, lambda=5.0106
norm of col 1 = 1.0000, lambda=0.8656
norm of col 2 = 1.0000, lambda=0.7284
norm of col 3 = 1.0000, lambda=0.1839
norm of col 4 = 1.0000, lambda=0.1219
norm of col 5 = 1.0000, lambda=0.0543
norm of col 6 = 1.0000, lambda=0.0353
</pre></div></div>
</div>
<p>We want to choose the first a few significant principal components, which is an easy task if the decomposition is sorted in descending order.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>idx = np.argsort(w)[::-1]
w = w[idx]
v = v[:,idx]
for i in range(len(w)):
    print(&quot;norm of col {:1d} = {:.4f}, lambda={:.4f}&quot;.format(i,np.linalg.norm(v[:,i]),w[i]))
column_names = [&quot;eig{:1d}&quot;.format(i) for i in range(len(w))]
V = pd.DataFrame(v,columns=column_names)
with pd.option_context(&#39;display.max_rows&#39;, None, &#39;display.max_columns&#39;, None):
  display(V)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
norm of col 0 = 1.0000, lambda=5.0106
norm of col 1 = 1.0000, lambda=0.8656
norm of col 2 = 1.0000, lambda=0.7284
norm of col 3 = 1.0000, lambda=0.1839
norm of col 4 = 1.0000, lambda=0.1219
norm of col 5 = 1.0000, lambda=0.0543
norm of col 6 = 1.0000, lambda=0.0353
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eig0</th>
      <th>eig1</th>
      <th>eig2</th>
      <th>eig3</th>
      <th>eig4</th>
      <th>eig5</th>
      <th>eig6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.398135</td>
      <td>0.206759</td>
      <td>-0.257215</td>
      <td>-0.750966</td>
      <td>-0.340776</td>
      <td>0.209759</td>
      <td>0.092212</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.416124</td>
      <td>0.198541</td>
      <td>0.139159</td>
      <td>-0.477306</td>
      <td>0.493222</td>
      <td>-0.332548</td>
      <td>0.431716</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.429283</td>
      <td>0.180362</td>
      <td>0.100316</td>
      <td>-0.297847</td>
      <td>0.056581</td>
      <td>0.142967</td>
      <td>-0.812877</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.422813</td>
      <td>0.085242</td>
      <td>-0.169684</td>
      <td>0.042076</td>
      <td>-0.711289</td>
      <td>-0.522803</td>
      <td>0.064385</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.414046</td>
      <td>0.224675</td>
      <td>0.276103</td>
      <td>0.107735</td>
      <td>-0.265158</td>
      <td>0.696518</td>
      <td>0.367154</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.284897</td>
      <td>-0.006972</td>
      <td>0.893308</td>
      <td>-0.121124</td>
      <td>-0.230755</td>
      <td>-0.223785</td>
      <td>-0.052799</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.229510</td>
      <td>0.909675</td>
      <td>-0.037246</td>
      <td>0.302435</td>
      <td>0.088961</td>
      <td>-0.128195</td>
      <td>-0.051132</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now, let’s see how each principal components are important than the others. First, we convert the eigenvalues into the percentage, and also compute the cumulative percentages as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>z = w/sum(w)*100
z_cumul = np.cumsum(z)
for i in range(len(z)):
    print(&quot;{:d} {:8.4f} {:8.4f}&quot;.format(i,z[i],z_cumul[i]))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0  71.5805  71.5805
1  12.3656  83.9461
2  10.4056  94.3517
3   2.6274  96.9791
4   1.7417  98.7207
5   0.7751  99.4959
6   0.5041 100.0000
</pre></div></div>
</div>
<p>The first (0-th) principal component takes 67.20% of information while second has 11.80% and so on and so forth. If we include first 4 principal components, then we can represent more than 90% of information that was in the raw data <span class="math notranslate nohighlight">\(\mathbf{X}^b\)</span>. Let’s do some plotting to visualize this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import matplotlib.pyplot as plt

fig, ax1 = plt.subplots(figsize=(5,3))
ax2 = plt.twinx()
_ = plt.xticks(range(len(z)),[&quot;PC{:1d}&quot;.format(i) for i in range(len(z))])


plt.sca(ax1)
plt.bar(range(len(z)),z)
ax1.set_facecolor(&quot;None&quot;)
plt.grid(False)
for i in range(len(z)):
    plt.text(i,z[i]+1,&quot;{:.2f}&quot;.format(z[i]),horizontalalignment=&quot;center&quot;)
plt.ylabel(&quot;Percentage [%]&quot;)
plt.ylim([0,79])

plt.sca(ax2)
plt.plot(range(len(z)),z_cumul,color=&quot;C1&quot;,marker=&quot;s&quot;)
ax1.set_facecolor(&quot;None&quot;)
plt.grid(False)
for i in range(1,len(z)):
    plt.text(i,z_cumul[i]-5,&quot;{:.2f}&quot;.format(z_cumul[i]),horizontalalignment=&quot;center&quot;,verticalalignment=&quot;top&quot;)
plt.ylabel(&quot;Cumulative Percentage [%]&quot;)
plt.ylim([0,107])

# Uncomment below if you want to save the figure.
#plt.tight_layout()
#plt.savefig(&quot;significance-r200.png&quot;,dpi=200)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0, 107)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/posts_pca_16_1.png" src="../_images/posts_pca_16_1.png" />
</div>
</div>
<p>Good. Since we only have 8 columns in <span class="math notranslate nohighlight">\(\mathbf{X}^b\)</span>, we do not actually have to reduce the dimension, but when there are so many, PCA will tell you the number of principal components and its ability of data representation.</p>
</div>
<div class="section" id="4.-Preprocessing">
<h2>4. Preprocessing<a class="headerlink" href="#4.-Preprocessing" title="Permalink to this headline">¶</a></h2>
<p>The last step is to get PCA-ed data, <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>. Simply do</p>
<p><span class="math">\begin{gather}
\mathbf{X}=\mathbf{X}^a\mathbf{V}
\end{gather}</span></p>
<p>and that’s it. Columns of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> are the principal components and their importance are from the greatest (the first column) to the smallest (the last column). If <span class="math notranslate nohighlight">\(\mathbf{V}\)</span>, which is sorted in descending order, is used as a whole, than <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> has the same size as <span class="math notranslate nohighlight">\(\mathbf{X}^b\)</span>, the raw file, but if some of the columns in <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> are discarded, <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> will have the same number of columns as the column-discarded <span class="math notranslate nohighlight">\(\mathbf{V}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>X_pca = X_norm.dot(v)
X_pca.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.631685</td>
      <td>-0.927853</td>
      <td>-0.533996</td>
      <td>-0.744639</td>
      <td>0.545311</td>
      <td>0.094853</td>
      <td>0.121922</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.489341</td>
      <td>-0.804445</td>
      <td>-0.648666</td>
      <td>-0.494197</td>
      <td>0.035590</td>
      <td>-0.206870</td>
      <td>-0.097737</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.966623</td>
      <td>-0.880062</td>
      <td>-0.957519</td>
      <td>-0.718806</td>
      <td>0.286542</td>
      <td>-0.136413</td>
      <td>0.059673</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.906483</td>
      <td>-0.960493</td>
      <td>-0.582209</td>
      <td>-0.530810</td>
      <td>0.283589</td>
      <td>-0.292865</td>
      <td>0.124362</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.900120</td>
      <td>-0.951573</td>
      <td>-1.053490</td>
      <td>-0.564380</td>
      <td>0.544107</td>
      <td>0.001894</td>
      <td>0.170608</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>That’s it. We use <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> instead of <span class="math notranslate nohighlight">\(\mathbf{X}^a\)</span> or <span class="math notranslate nohighlight">\(\mathbf{X}^b\)</span> for the machine learning.</p>
<p>Let’s check if the PCA-ed data doesn’t have multicollinearity, i.e. covariance matrix is diagonal.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>C = X_pca.cov()
C.values[C.values &lt; 1e-14] = 0 # Supress small numbers to zero.
with pd.option_context(&#39;display.max_rows&#39;, None, &#39;display.max_columns&#39;, None):
  display(C)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.010636</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000000</td>
      <td>0.865591</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.728394</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.183915</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.121916</td>
      <td>0.000000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.054257</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.03529</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Yes it is. And the diagonal entries are indeed the eigenvalues. Check it out.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>for i, eigval in enumerate(w):
  print(&quot;lambda[{:1d}] = {:.4f}&quot;.format(i,eigval))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
lambda[0] = 5.0106
lambda[1] = 0.8656
lambda[2] = 0.7284
lambda[3] = 0.1839
lambda[4] = 0.1219
lambda[5] = 0.0543
lambda[6] = 0.0353
</pre></div></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index_posts.html" class="btn btn-neutral" title="Study" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Seungbum Koo.
      Last updated on Dec 17, 2019.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../None"></script>
      <script type="text/javascript" src="../_static/jquery.fancybox.min.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
  <script type="text/javascript">
    $(function(){
      $('.image-reference').fancybox();
    })
  </script>

</body>
</html>